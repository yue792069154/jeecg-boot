<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.electrical.tBusElectricDevice.mapper.TBusElectricDeviceMonitorPointMapper">


    <select id="queryList" parameterType="Object" resultType="org.jeecg.modules.electrical.tBusElectricDevice.entity.TBusElectricDeviceMonitorPoint">
        SELECT
        t1.point_name,
        t1.id point_id,
        t1.point_code,
        t2.device_code,
        t1.point_standard_l,
        t1.point_standard_u,
        group_concat( t2.device_code ) deviceCodes
        FROM
        t_bus_electric_monitor_point t1
        LEFT JOIN t_bus_electric_device_monitor_point t2 ON t1.point_code = t2.point_id
        WHERE
        t1.delete_code = '0'

        <if test="tBusElectricDeviceMonitorPoint.keyword != null and tBusElectricDeviceMonitorPoint.keyword != ''">
            AND t1.point_name LIKE '%${tBusElectricDeviceMonitorPoint.keyword}%'
        </if>
        <if test="tBusElectricDeviceMonitorPoint.statusCode != null and tBusElectricDeviceMonitorPoint.statusCode != ''">
            AND t2.status_code = #{tBusElectricDeviceMonitorPoint.statusCode}
        </if>

        GROUP BY
        t1.id  ORDER BY t1.sort ASC
    </select>

</mapper>